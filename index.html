<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GUANES | Justicia Digital Premium</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            --primary: #0F172A; --brand: #2563EB; --accent: #F59E0B;
            --bg: #F0F4F8; --gradient: linear-gradient(135deg, #2563EB 0%, #1E40AF 100%);
        }
        body { font-family: 'Outfit', sans-serif; background: var(--bg); color: #334155; margin: 0; line-height: 1.6; }
        * { box-sizing: border-box; }

        header { background: linear-gradient(180deg, #ffffff 0%, #e2e8f0 100%); padding: 5rem 1rem 4rem; text-align: center; border-bottom: 1px solid #cbd5e1; }
        h1 { font-size: 3rem; font-weight: 800; color: var(--primary); margin: 0; line-height: 1.1; }
        .badge { background: #dbeafe; color: var(--brand); padding: 8px 20px; border-radius: 50px; font-weight: 700; font-size: 0.85rem; text-transform: uppercase; margin-bottom: 1.5rem; display: inline-block; }

        #app-generator { background: var(--primary); padding: 4rem 1rem; background-image: radial-gradient(#1e293b 1px, transparent 1px); background-size: 20px 20px; }
        .app-box { background: white; max-width: 800px; margin: 0 auto; border-radius: 20px; padding: 3rem; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); border-top: 6px solid var(--accent); }

        .input-group { margin-bottom: 1.5rem; }
        label { display: block; font-weight: 700; font-size: 0.95rem; margin-bottom: 0.5rem; color: #1e293b; }
        .input-control { width: 100%; padding: 14px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 1rem; font-family: inherit; background: #f8fafc; transition: 0.3s; }
        .input-control:focus { outline: none; border-color: var(--brand); background: #fff; }
        
        .btn-generate { width: 100%; padding: 1.2rem; font-size: 1.2rem; font-weight: 800; color: white; background: var(--gradient); border: none; border-radius: 12px; cursor: pointer; margin-top: 1.5rem; text-transform: uppercase; box-shadow: 0 10px 15px -3px rgba(37,99,235,0.4); transition: 0.3s; }
        .btn-generate:hover { transform: translateY(-3px); filter: brightness(1.1); }
        .btn-generate:disabled { background: #94a3b8; cursor: wait; transform: none; }

        .hidden { display: none; }
        .highlight-box { padding: 1.5rem; border-radius: 12px; margin-bottom: 1.5rem; border: 1px solid #e2e8f0; }
        
        /* Temas por color seg√∫n √°rea */
        .theme-laboral { background: #eff6ff; border-color: #bfdbfe; }
        .theme-contratos { background: #fff7ed; border-color: #fed7aa; }
        .theme-transito { background: #f0fdf4; border-color: #bbf7d0; } /* Verde */
        .theme-salud { background: #fef2f2; border-color: #fecaca; } /* Rojo */
        .theme-civil { background: #faf5ff; border-color: #e9d5ff; } /* Morado */

        h4 i { margin-right: 8px; }
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; }
        @media(max-width: 600px) { .grid-2 { grid-template-columns: 1fr; } h1 { font-size: 2.2rem; } .app-box { padding: 1.5rem; } }
    </style>
</head>
<body>

    <header>
        <span class="badge">‚ú® Oficina Virtual 24/7</span>
        <h1>GUANES <span style="color:var(--brand);">LEGAL</span></h1>
        <p style="font-size: 1.2rem; max-width: 600px; margin: 10px auto; color: #475569;">Supervisi√≥n experta del Dr. Manuel Prada Forero.</p>
    </header>

    <section id="app-generator">
        <div class="app-box">
            <h2 style="text-align:center; color:var(--primary); margin-bottom: 2rem;">Radicaci√≥n de Caso</h2>

            <form id="legalForm">
                
                <div class="input-group">
                    <label style="color: var(--brand); font-size: 1.1rem;">Seleccione el Tr√°mite:</label>
                    <select class="input-control" name="Menu" id="servicioSelect" onchange="toggleFields()" required style="background: #eff6ff; border-color: var(--brand); font-weight: 600;">
                        <option value="" disabled selected>üëá Seleccione aqu√≠...</option>
                        <option value="Liquidaci√≥n y Demandas Laborales">üë∑‚Äç‚ôÇÔ∏è Laboral: Liquidaci√≥n / Despido</option>
                        <option value="Contratos y Arrendamientos">üè† Contratos: Arrendamiento / Compraventa</option>
                        <option value="Derecho de Petici√≥n y Fotomultas">üì∑ Tr√°nsito: Fotomultas / Comparendos</option>
                        <option value="Acciones de Tutela">üè• Salud: Tutela (Medicamentos/Citas)</option>
                        <option value="Cobro Jur√≠dico">üí∞ Civil: Cobro de Deudas (Cartera)</option>
                        <option value="Concepto de Viabilidad y An√°lisis de Caso">‚öñÔ∏è Consultor√≠a: Concepto Jur√≠dico</option>
                    </select>
                </div>

                <div class="grid-2">
                    <div class="input-group"><label>C√≥digo Wompi:</label><input type="text" class="input-control" name="ReferenciaPago" placeholder="Ej: TEST" required></div>
                    <div class="input-group"><label>C√©dula Cliente:</label><input type="text" class="input-control" name="ID" required></div>
                </div>
                <div class="grid-2">
                    <div class="input-group"><label>Nombre Completo:</label><input type="text" class="input-control" name="Nombre" required></div>
                    <div class="input-group"><label>Email (Para el PDF):</label><input type="email" class="input-control" name="Correo" required></div>
                </div>
                <div class="grid-2">
                    <div class="input-group"><label>Ciudad:</label><input type="text" class="input-control" name="Ciudad" required></div>
                    <div class="input-group"><label>Contraparte (A qui√©n reclamamos):</label><input type="text" class="input-control" name="Contraparte" placeholder="Empresa, EPS, Tr√°nsito o Persona" required></div>
                </div>

                <hr style="border:0; border-top:1px solid #e2e8f0; margin:2rem 0;">

                <div id="camposLaborales" class="hidden highlight-box theme-laboral">
                    <h4 style="color:var(--brand);"><i class="fas fa-briefcase"></i> Datos Laborales</h4>
                    <div class="grid-2">
                        <div class="input-group"><label>Fecha Ingreso:</label><input type="date" class="input-control" name="fecha_inicio"></div>
                        <div class="input-group"><label>Fecha Retiro:</label><input type="date" class="input-control" name="fecha_fin"></div>
                    </div>
                    <div class="grid-2">
                        <div class="input-group"><label>Salario ($):</label><input type="number" class="input-control" name="salario"></div>
                        <div class="input-group">
                            <label>Motivo Salida:</label>
                            <select class="input-control" name="motivo_salida">
                                <option value="Despido Sin Justa Causa">Despido Injusto</option>
                                <option value="Renuncia Voluntaria">Renuncia</option>
                                <option value="Terminaci√≥n de Contrato">Fin de Contrato</option>
                                <option value="Despido Con Justa Causa">Despido Justo</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div id="camposContratos" class="hidden highlight-box theme-contratos">
                    <h4 style="color:#ea580c;"><i class="fas fa-file-contract"></i> Datos del Inmueble</h4>
                    <div class="input-group"><label>Direcci√≥n:</label><input type="text" class="input-control" name="arriendo_direccion"></div>
                    <div class="grid-2">
                        <div class="input-group"><label>Canon ($):</label><input type="number" class="input-control" name="arriendo_canon"></div>
                        <div class="input-group"><label>Duraci√≥n (Meses):</label><input type="number" class="input-control" name="arriendo_duracion"></div>
                    </div>
                    <div class="grid-2">
                        <div class="input-group"><label>Inicio:</label><input type="date" class="input-control" name="arriendo_inicio"></div>
                        <div class="input-group"><label>Uso:</label><select class="input-control" name="arriendo_uso"><option>Vivienda Urbana</option><option>Comercial</option><option>Oficina</option></select></div>
                    </div>
                </div>

                <div id="camposTransito" class="hidden highlight-box theme-transito">
                    <h4 style="color:#166534;"><i class="fas fa-car"></i> Datos del Comparendo</h4>
                    <div class="grid-2">
                        <div class="input-group"><label>Placa Veh√≠culo:</label><input type="text" class="input-control" name="transito_placa" placeholder="ABC-123"></div>
                        <div class="input-group"><label>Fecha Infracci√≥n:</label><input type="date" class="input-control" name="transito_fecha"></div>
                    </div>
                    <div class="input-group">
                        <label>¬øLe notificaron a tiempo a su direcci√≥n?</label>
                        <select class="input-control" name="transito_notificacion">
                            <option value="NO me notificaron">NO (Me enter√© despu√©s/Al vender)</option>
                            <option value="SI me notificaron">S√ç me lleg√≥ la carta</option>
                        </select>
                    </div>
                    <div class="input-group"><label>N√∫mero de Comparendo (Opcional):</label><input type="text" class="input-control" name="transito_numero"></div>
                </div>

                <div id="camposSalud" class="hidden highlight-box theme-salud">
                    <h4 style="color:#dc2626;"><i class="fas fa-heartbeat"></i> Datos de la Tutela</h4>
                    <div class="input-group">
                        <label>¬øQu√© le est√°n negando?</label>
                        <input type="text" class="input-control" name="salud_negacion" placeholder="Ej: Entrega de Insulina, Cita con Especialista, Cirug√≠a...">
                    </div>
                    <div class="input-group">
                        <label>Nivel de Urgencia (Riesgo de Vida):</label>
                        <select class="input-control" name="salud_riesgo">
                            <option value="Urgencia Vital (Peligro de Muerte)">ALTO - Mi vida corre peligro (Medida Provisional)</option>
                            <option value="Afectaci√≥n Calidad de Vida">MEDIO - Afecta mi calidad de vida</option>
                            <option value="Tr√°mite Administrativo">BAJO - Es un tema administrativo</option>
                        </select>
                    </div>
                </div>

                <div id="camposCivil" class="hidden highlight-box theme-civil">
                    <h4 style="color:#7e22ce;"><i class="fas fa-money-bill-wave"></i> Datos de la Deuda</h4>
                    <div class="grid-2">
                        <div class="input-group">
                            <label>Tipo de Soporte:</label>
                            <select class="input-control" name="civil_tipo">
                                <option value="Letra de Cambio">Letra de Cambio</option>
                                <option value="Factura">Factura de Venta</option>
                                <option value="Contrato Incumplido">Contrato Incumplido</option>
                                <option value="Acuerdo Verbal">Pr√©stamo Verbal (Sin papeles)</option>
                            </select>
                        </div>
                        <div class="input-group"><label>Fecha Vencimiento:</label><input type="date" class="input-control" name="civil_vencimiento"></div>
                    </div>
                    <div class="input-group"><label>Monto de la Deuda ($):</label><input type="number" class="input-control" name="civil_monto"></div>
                </div>

                <div id="campoRelato">
                    <div class="input-group">
                        <label>Detalles Adicionales (Importante):</label>
                        <textarea class="input-control" name="Relato" style="min-height: 100px;" placeholder="Agregue cualquier otro detalle clave para el abogado..."></textarea>
                    </div>
                </div>

                <button type="submit" class="btn-generate" id="submitBtn">
                    <i class="fas fa-bolt"></i> GENERAR DOCUMENTO
                </button>

            </form>
            <div id="statusMessage"></div>
        </div>
    </section>

    <footer>
        <p>¬© 2026 GUANES Legal Tech | Dr. Manuel Enrique Prada Forero</p>
    </footer>

    <script>
        // ==========================================
        // ‚ö†Ô∏è SU WEBHOOK DE N8N VA AQU√ç ‚ö†Ô∏è
        // ==========================================
        const WEBHOOK_URL = "https://guanes.app.n8n.cloud/webhook-test/cb4edfe2-eaea-47dd-8f97-22afccd72810"; 
        // ==========================================

        function toggleFields() {
            const s = document.getElementById('servicioSelect').value;
            
            // IDs de todos los m√≥dulos
            const mods = {
                laboral: document.getElementById('camposLaborales'),
                contratos: document.getElementById('camposContratos'),
                transito: document.getElementById('camposTransito'),
                salud: document.getElementById('camposSalud'),
                civil: document.getElementById('camposCivil')
            };

            // 1. Ocultar todo
            Object.values(mods).forEach(d => {
                d.classList.add('hidden');
                setRequired(d, false); // Quitar required
            });

            // 2. Mostrar seg√∫n selecci√≥n
            if (s.includes("Laboral")) show(mods.laboral);
            else if (s.includes("Contratos")) show(mods.contratos);
            else if (s.includes("Tr√°nsito") || s.includes("Fotomultas")) show(mods.transito);
            else if (s.includes("Tutela") || s.includes("Salud")) show(mods.salud);
            else if (s.includes("Cobro") || s.includes("Civil")) show(mods.civil);
        }

        function show(div) {
            div.classList.remove('hidden');
            setRequired(div, true);
        }

        function setRequired(div, isReq) {
            div.querySelectorAll('input, select').forEach(i => i.required = isReq);
            // El campo opcional de comparendo no debe ser required nunca
            const opcional = div.querySelector('[name="transito_numero"]');
            if(opcional) opcional.required = false;
        }

        const form = document.getElementById('legalForm');
        const statusDiv = document.getElementById('statusMessage');
        const submitBtn = document.getElementById('submitBtn');

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> PROCESANDO...';
            statusDiv.style.display = 'block';
            statusDiv.style.background = '#eff6ff';
            statusDiv.style.color = '#2563EB';
            statusDiv.innerHTML = '<h3>‚è≥ Analizando Caso...</h3><p>Validando jurisprudencia y redactando...</p>';

            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            data.MarcaTemporal = new Date().toISOString();

            try {
                const response = await fetch(WEBHOOK_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `Documento_GUANES_${data.Nombre.replace(/\s+/g, '_')}.pdf`;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(url);
                    
                    statusDiv.style.background = '#ecfdf5';
                    statusDiv.style.color = '#047857';
                    statusDiv.innerHTML = '<h3>‚úÖ ¬°LISTO!</h3><p>Descarga completada con √©xito.</p>';
                    form.reset();
                    toggleFields();
                } else { throw new Error('Error'); }
            } catch (error) {
                statusDiv.style.background = '#fef2f2';
                statusDiv.style.color = '#b91c1c';
                statusDiv.innerHTML = '<h3>‚ùå ERROR</h3><p>Verifique su conexi√≥n.</p>';
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-bolt"></i> GENERAR DOCUMENTO';
            }
        });
    </script>
</body>
</html>